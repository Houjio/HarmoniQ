import pandas as pd
import numpy as np

# Definition manuscrite des courbes de puissances des 17 modèles d'éoliennes actuellement présentes au QC

# Senvion 3.2-M114 (https://en.wind-turbine-models.com/turbines/882-senvion-3.2m114)
_senvion_32m114 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
            ],
            "power": [
                p * 1000
                for p in [
                    23,
                    139,
                    330,
                    604,
                    990,
                    1502,
                    2102,
                    2697,
                    3098,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 22,
}

# Enercon E-126 EP3 4.0MW (https://en.wind-turbine-models.com/turbines/1901-enercon-e-126-ep3-4.0mw et https://www.thewindpower.net/turbine_en_1576_enercon_e126-4000.php)
_enercon_e126_4 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                2.5,
                3,
                3.5,
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
                22.5,
                23,
                23.5,
                24,
                24.5,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    20,
                    47,
                    95,
                    150,
                    290,
                    441,
                    582,
                    732,
                    945,
                    1165,
                    1430,
                    1700,
                    2012,
                    2323,
                    2677,
                    3023,
                    3270,
                    3504,
                    3698,
                    3880,
                    3917,
                    3945,
                    3959,
                    3969,
                    3995,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    4000,
                    3985,
                    3960,
                    3960,
                    3952,
                    3930,
                    3898,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 2.5,
    "cut_out_wind_speed": 25,
}

# Enercon E-138 EP2  4.2MW pas d'informations disponibles pour le power-curve
_enercon_e138_42 = {
    "cut_in_wind_speed": 2.5,
    "cut_out_wind_speed": 34,
}

# Enercon E-70 E4 2.3MW (https://en.wind-turbine-models.com/turbines/69-enercon-e-70-e4-2.300)
_enercon_e70_23 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    2,
                    18,
                    56,
                    127,
                    240,
                    400,
                    626,
                    892,
                    1223,
                    1590,
                    1900,
                    2080,
                    2230,
                    2300,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                    2310,
                ]
            ],
            "power_coefficient": [
                0.1,
                0.270,
                0.36,
                0.42,
                0.46,
                0.48,
                0.5,
                0.5,
                0.5,
                0.49,
                0.45,
                0.39,
                0.34,
                0.28,
                0.23,
                0.19,
                0.16,
                0.14,
                0.12,
                0.1,
                0.09,
                0.08,
                0.07,
                0.06,
            ],
        }
    ),
    "cut_in_wind_speed": 2.5,
    "cut_out_wind_speed": 34,
}

# Enercon E-82 E2 2MW (https://en.wind-turbine-models.com/turbines/835-enercon-e-82-e2-2.000)
_enercon_e82_2 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    3,
                    25,
                    82,
                    174,
                    321,
                    532,
                    815,
                    1180,
                    1580,
                    1810,
                    1980,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                ]
            ],
            "power_coefficient": [
                0.12,
                0.29,
                0.4,
                0.43,
                0.46,
                0.48,
                0.49,
                0.5,
                0.49,
                0.42,
                0.35,
                0.29,
                0.23,
                0.19,
                0.15,
                0.13,
                0.11,
                0.09,
                0.08,
                0.07,
                0.06,
                0.05,
                0.05,
                0.04,
            ],
        }
    ),
    "cut_in_wind_speed": 2,
    "cut_out_wind_speed": 34,
}

# Enercon E-82 E2 2.3MW (https://fr.wind-turbine-models.com/turbines/550-enercon-e-82-e2-2.300)
_enercon_e82_23 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    3,
                    25,
                    82,
                    174,
                    321,
                    532,
                    815,
                    1180,
                    1580,
                    1890,
                    2100,
                    2250,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                ]
            ],
            "power_coefficient": [
                0.12,
                0.29,
                0.4,
                0.43,
                0.46,
                0.48,
                0.49,
                0.5,
                0.49,
                0.44,
                0.38,
                0.32,
                0.26,
                0.22,
                0.18,
                0.15,
                0.12,
                0.11,
                0.09,
                0.08,
                0.07,
                0.06,
                0.05,
                0.05,
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 34,
}

# Enercon E-82 E4 3MW (https://en.wind-turbine-models.com/turbines/833-enercon-e-82-e4-3.000)
_enercon_e82_3 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    25,
                    82,
                    174,
                    321,
                    525,
                    800,
                    1135,
                    1510,
                    1880,
                    2200,
                    2500,
                    2770,
                    2910,
                    3000,
                    3020,
                    3020,
                    3020,
                    3020,
                    3020,
                    3020,
                    3020,
                    3020,
                    3020,
                ]
            ],
            "power_coefficient": [
                0.286,
                0.396,
                0.43,
                0.459,
                0.473,
                0.483,
                0.481,
                0.467,
                0.437,
                0.394,
                0.352,
                0.312,
                0.267,
                0.226,
                0.19,
                0.16,
                0.136,
                0.117,
                0.101,
                0.088,
                0.077,
                0.068,
                0.06,
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 34,
}

# Enercon E-92 2.35MW (https://en.wind-turbine-models.com/turbines/131-enercon-e-92)
_enercon_e92_235 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    29.9,
                    98.2,
                    208.3,
                    384.3,
                    637,
                    975.8,
                    1403.6,
                    1817.8,
                    2088.7,
                    2237,
                    2300,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                    2350,
                ]
            ],
            "power_coefficient": [
                0.11,
                0.27,
                0.38,
                0.41,
                0.44,
                0.46,
                0.47,
                0.47,
                0.45,
                0.39,
                0.32,
                0.26,
                0.21,
                0.17,
                0.14,
                0.12,
                0.1,
                0.08,
                0.07,
                0.06,
                0.05,
                0.05,
                0.04,
                0.04,
            ],
        }
    ),
    "cut_in_wind_speed": 2,
    "cut_out_wind_speed": 25,
}

# General Electric GE 1.5sle 1.5MW (https://www.thewindpower.net/turbine_en_57_ge-energy_1.5sle.php)
_ge_15sle = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3,
                3.5,
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
                22.5,
                23,
                23.5,
                24,
                24.5,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    4,
                    20,
                    48,
                    89,
                    130,
                    194,
                    257,
                    338,
                    418,
                    535,
                    652,
                    795,
                    938,
                    1071,
                    1203,
                    1277,
                    1351,
                    1394,
                    1437,
                    1459,
                    1480,
                    1488,
                    1496,
                    1498,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                    1500,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 25,
}

# General ELectric GE 2.2-107 2.2MW pas d'informations disponibles pour le power-curve.
# Les données utilisées sont fictives et temporaires.
_ge_22_107 = {
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 25,
}

# Senvion MM82 2.05MW (https://www.thewindpower.net/turbine_en_464_senvion_mm82-2050.php)
_senvion_mm82 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
            ],
            "power": [
                p * 1000
                for p in [
                    55,
                    110,
                    186,
                    264,
                    342,
                    424,
                    506,
                    618,
                    730,
                    865,
                    999,
                    1195,
                    1391,
                    1558,
                    1724,
                    1829,
                    1909,
                    1960,
                    2002,
                    2025,
                    2044,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 4,
    "cut_out_wind_speed": 22,
}

# Senvion MM92 2.05MW (https://www.thewindpower.net/turbine_en_327_senvion_mm92-2050.php)
_senvion_mm92 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3.5,
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
            ],
            "power": [
                p * 1000
                for p in [
                    42,
                    85,
                    142,
                    200,
                    276,
                    353,
                    472,
                    591,
                    740,
                    890,
                    1138,
                    1386,
                    1557,
                    1728,
                    1835,
                    1942,
                    1990,
                    2009,
                    2040,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                    2050,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 3.5,
    "cut_out_wind_speed": 22,
}

# NEG Micon NM48/750 (https://en.wind-turbine-models.com/turbines/311-neg-micon-nm-48-750)
_nm48_750 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3.5,
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
            ],
            "power": [
                p * 1000
                for p in [
                    4.4,
                    16.68,
                    33.79,
                    50.41,
                    68.23,
                    89.77,
                    122.1,
                    159.1,
                    198.7,
                    247.4,
                    294.3,
                    347.6,
                    393.4,
                    446.2,
                    499.4,
                    543.8,
                    591.5,
                    640.2,
                    680.5,
                    712.4,
                    735.5,
                    751.9,
                    767.5,
                    774.6,
                    774.2,
                    769.2,
                    761.1,
                    749.7,
                    735.1,
                    715.5,
                    706.3,
                    697.2,
                    692.9,
                    683.3,
                    652.8,
                ]
            ],
            "power_coefficient": [
                0.09,
                0.23,
                0.33,
                0.36,
                0.37,
                0.37,
                0.4,
                0.42,
                0.42,
                0.43,
                0.43,
                0.43,
                0.41,
                0.4,
                0.39,
                0.37,
                0.35,
                0.33,
                0.31,
                0.29,
                0.27,
                0.25,
                0.23,
                0.21,
                0.19,
                0.17,
                0.15,
                0.14,
                0.12,
                0.11,
                0.1,
                0.09,
                0.08,
                0.08,
                0.07,
            ],
        }
    ),
    "cut_in_wind_speed": 4,
    "cut_out_wind_speed": 25,
}

# Siemens SWT-2.3-113 (https://en.wind-turbine-models.com/turbines/966-siemens-swt-3.2-113)
_swt_23_113 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
            ],
            "power": [
                p * 1000
                for p in [
                    64,
                    169,
                    350,
                    623,
                    1004,
                    1506,
                    2115,
                    2712,
                    3083,
                    3187,
                    3199,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                    3200,
                ]
            ],
            "power_coefficient": [
                0.39,
                0.43,
                0.46,
                0.47,
                0.48,
                0.48,
                0.47,
                0.44,
                0.38,
                0.3,
                0.24,
                0.19,
                0.15,
                0.13,
                0.11,
                0.09,
                0.08,
                0.07,
                0.06,
                0.05,
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 25,
}

# Vestas V117-3.45 3.45MW (https://en.wind-turbine-models.com/turbines/1248-vestas-v117-3.45)
_vestas_v117_345 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                3,
                3.5,
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
                22.5,
                23,
                23.5,
                24,
                24.5,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    22,
                    78,
                    150,
                    237,
                    340,
                    466,
                    617,
                    796,
                    1006,
                    1247,
                    1522,
                    1831,
                    2178,
                    2544,
                    2905,
                    3201,
                    3374,
                    3434,
                    3448,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                    3450,
                ]
            ],
            "power_coefficient": [
                0.124,
                0.276,
                0.356,
                0.395,
                0.413,
                0.425,
                0.434,
                0.44,
                0.445,
                0.449,
                0.451,
                0.453,
                0.454,
                0.451,
                0.441,
                0.420,
                0.385,
                0.343,
                0.303,
                0.268,
                0.238,
                0.213,
                0.191,
                0.172,
                0.155,
                0.141,
                0.128,
                0.117,
                0.107,
                0.098,
                0.09,
                0.083,
                0.076,
                0.071,
                0.065,
                0.061,
                0.057,
                0.053,
                0.049,
                0.046,
                0.043,
                0.04,
                0.038,
                0.036,
                0.034,
            ],
        }
    ),
    "cut_in_wind_speed": 3,
    "cut_out_wind_speed": 25,
}

# Vestas V80-1.8 1.8MW (https://en.wind-turbine-models.com/turbines/1350-vestas-v80-1.8)
_vestas_v80_18 = {
    "power_curve": pd.DataFrame(
        {
            "wind_speed": [
                4,
                4.5,
                5,
                5.5,
                6,
                6.5,
                7,
                7.5,
                8,
                8.5,
                9,
                9.5,
                10,
                10.5,
                11,
                11.5,
                12,
                12.5,
                13,
                13.5,
                14,
                14.5,
                15,
                15.5,
                16,
                16.5,
                17,
                17.5,
                18,
                18.5,
                19,
                19.5,
                20,
                20.5,
                21,
                21.5,
                22,
                22.5,
                23,
                23.5,
                24,
                24.5,
                25,
            ],
            "power": [
                p * 1000
                for p in [
                    11.43,
                    60.22,
                    109,
                    181,
                    253,
                    343.87,
                    443,
                    562.5,
                    682,
                    825,
                    968,
                    1133.91,
                    1286,
                    1434,
                    1582,
                    1665,
                    1748,
                    1771.48,
                    1793,
                    1796,
                    1799,
                    1799.52,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                    1800,
                ]
            ],
        }
    ),
    "cut_in_wind_speed": 4,
    "cut_out_wind_speed": 25,
}

turbine_models = {
    "E126-4.0": _enercon_e126_4,
    "E138-4.2": _enercon_e138_42,
    "E70-2.3": _enercon_e70_23,
    "E82-2.0": _enercon_e82_2,
    "E82-2.3": _enercon_e82_23,
    "E82-3.0": _enercon_e82_3,
    "E92-2.35": _enercon_e92_235,
    "GE 1.5SLE": _ge_15sle,
    "GE 2.2-107": _ge_22_107,
    "NM48/750": _nm48_750,
    "3.2-MM114": _senvion_32m114,
    "MM82": _senvion_mm82,
    "MM92": _senvion_mm92,
    "MM92 CCV": _senvion_mm92,  # Pas d'informations pour ce modèle. On impose le modèle Senvion MM92 de façon temporaire.
    "SWT 3.2-113": _swt_23_113,
    "V117-3.45": _vestas_v117_345,
    "V80-1.8": _vestas_v80_18,
}
